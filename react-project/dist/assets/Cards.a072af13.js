import{r as a,T as L,E,j as e,a as d,F as D,K as O,c as g,f as A,b as P,U as I}from"./index.a2654dfd.js";import{C as T,a as k}from"./CardSettingsDropdown.00794e5c.js";import{b as B,C as F,g as R,d as U}from"./cardStorage.b3eaf0dc.js";/* empty css                    */import j from"./SignIn.3133c1b1.js";import"./DeleteMsg.0b3d060c.js";import"./InputGroup.3a294cd1.js";import"./Modal.e6fddb49.js";function _({cards:i,onDelete:m}){const{theme:r}=a.exports.useContext(L),{user:t}=a.exports.useContext(E),[u,o]=a.exports.useState(!1),[h,c]=a.exports.useState(null);let C=a.exports.useRef();a.exports.useEffect(()=>{let l=s=>{C.current&&!C.current.contains(s.target)&&document.getElementById("card-num: "+h)&&!document.getElementById("card-num: "+h).contains(s.target)&&o(!1)};return document.addEventListener("mousedown",l),document.addEventListener("touchstart",l),()=>{document.removeEventListener("mousedown",l),document.removeEventListener("touchstart",l)}});const x=l=>{const[s,n]=l.split(", "),[p,f,b]=s.split("/"),[w,y,S]=n.split(":");return new Date(b,f-1,p,w,y,S)},v=i.sort((l,s)=>{const n=x(l.businessCreateDate);return x(s.businessCreateDate)-n});return i.length==0?e("div",{className:`not-found-container body-${r} d-grid `,children:e("div",{className:`not-found-content-container components-${r}`,children:d("div",{className:"not-found-content ",children:[e("h1",{children:"No Cards"}),e("p",{children:"Time to create a new Card!"})]})})}):e("div",{className:"cards-area-grid",children:(()=>v.map((s,n)=>e("div",{className:"cards-col",children:d("div",{className:`card-container  business-cards-${r}`,children:[e("div",{className:`card-image business-cards-image-${r}`,style:{backgroundImage:`url(${s.businessImage==="businessDefaultCardImage"?B:s.businessImage})`}}),e("div",{className:`card-title-container card-title-container-${r}`,children:d("div",{className:"card-title ps-3 pe-1 pt-2",children:[d("div",{className:"business-title col-10 text-truncate",children:[e("h2",{children:s.businessName}),e("h3",{children:s.cardEditor})]}),t&&t.isAdminAccount||(t==null?void 0:t._id)===s.userId?d("div",{ref:C,id:"card-num: "+n,className:"card-settings",children:[e("div",{className:"menu-trigger",onClick:()=>{o(!u),c(n)},children:e(D,{icon:O,className:"card-settings-dot"})}),e("div",{className:`dropdown-menu-custom  dropdown-menu-box-${r}  ${u&&h===n?"active":"inactive"} `,children:e("ul",{children:e(T,{card:s,id:n,onDelete:m,setOpen:o})})})]}):e(g,{})]})}),d("div",{className:"card-content ",children:[e("div",{className:"last-updated mx-2",children:d("small",{children:["Last updated: ",s.businessCreateDate]})}),e("div",{className:"description my-2 mx-2",children:s.businessDescription}),d("div",{className:"phone my-2",children:[e("div",{className:"phone-address-icon",children:e(D,{icon:A,className:""})}),e("div",{className:"phone-number",children:s.businessPhone})]}),d("div",{className:"address mb-2",children:[e("div",{className:"phone-address-icon",children:e(D,{icon:P,className:""})}),e("div",{className:"address-info",children:s.businessAddress})]}),e("div",{className:"get-details-btn me-2",children:e(F,{card:s})})]})]},s._id)},n)))()})}function K(i){const[m,r]=a.exports.useState(""),[t,u]=a.exports.useState(""),[o,h]=a.exports.useState("");return e("div",{className:"search-cards-container mb-4",children:d("div",{className:"search-cards-grid",children:[e("div",{className:"search-text-place",children:e("input",{className:"search-text ",type:"text",placeholder:"Search",value:m,onChange:c=>{r(c.target.value),i.onChange(c.target.value,t,o)}})}),e("div",{className:"search-text-place",children:d("select",{className:"search-select",name:"search-by",value:t,onChange:c=>{u(c.target.value),i.onChange(m,c.target.value,o)},children:[e("option",{children:"Search by..."}),e("option",{children:"Company name"}),e("option",{children:"Creator"}),e("option",{children:"Phone"}),e("option",{children:"address"})]})}),e("div",{className:"search-text-place",children:e("input",{className:"search-date",type:"date",value:o,onChange:c=>{h(c.target.value),i.onChange(m,t,c.target.value)}})})]})})}function M(){const[i,m]=a.exports.useState([]),{token:r}=a.exports.useContext(I),[t,u]=a.exports.useState(""),[o,h]=a.exports.useState(""),[c,C]=a.exports.useState("");a.exports.useEffect(()=>{N()},[]);function x(s,n,p){u(s),h(n),C(p)}function v(s){U(s,r).then(n=>{N()}).catch(n=>console.error(n))}function N(){R().then(s=>{console.log(s),m([...s])}).catch(s=>console.log(s.message))}const l=a.exports.useMemo(()=>i.filter(s=>{let n=new Date(s.businessCreateDate).toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"});const[p,f,b]=c.split("-"),w=`${b}/${f}/${p}`,y=c==="dd/mm/yyyy"||n===w||!c,S=o==="Search by..."||s.businessName.toLowerCase().indexOf(t.toLowerCase())>-1&&o==="Company name"||s.cardEditor.toLowerCase().indexOf(t.toLowerCase())>-1&&o==="Creator"||s.businessPhone.toLowerCase().indexOf(t.toLowerCase())>-1&&o==="Phone"||s.businessAddress.toLowerCase().indexOf(t.toLowerCase())>-1&&o==="address"||!o,$=!t||s.businessName.toLowerCase().indexOf(t.toLowerCase())>-1||s.cardEditor.toLowerCase().indexOf(t.toLowerCase())>-1||s.businessPhone.indexOf(t)>-1||s.businessAddress.toLowerCase().indexOf(t.toLowerCase())>-1;return y&&$&&S}),[i,t,c,o]);return d(g,{children:[e(K,{onChange:x}),e(_,{cards:l,onDelete:v})]})}function X(){const{theme:i}=a.exports.useContext(L),{token:m}=a.exports.useContext(I),{user:r}=a.exports.useContext(E);return e(g,{children:!m&&!r?e(j,{}):e(g,{children:e("div",{className:`page-container body-${i} h-100`,children:d("div",{className:"page-content-container my-4",children:[e("div",{className:`page-title-area mb-3 components-${i} `,children:d("div",{className:"title-grid-holder ms-3",children:[e("div",{className:"page-title",children:e("h1",{className:"m-0",children:"Cards"})}),r!=null&&r.isBusinessAccount?e("div",{className:"title-btn-area me-3",children:e(k,{})}):e(g,{})]})}),e(M,{})]})})})})}export{X as default};
