import{r as f,T as z,j as s,c as q,x as ue,U as ce,E as Ne,a as o,C as te,F as I,N as le,b as he,f as de,O as me,P as fe}from"./index.a2654dfd.js";import{F as d}from"./DeleteMsg.0b3d060c.js";import{I as p}from"./InputGroup.3a294cd1.js";import{M as y}from"./Modal.e6fddb49.js";import{a as _e,u as Te}from"./cardStorage.b3eaf0dc.js";function pe(t,{lenient:e=!1}={}){if(typeof t!="string")throw new TypeError("Expected a string");if(t=t.trim(),t.includes(" "))return!1;try{return new URL(t),!0}catch{return e?pe(`https://${t}`):!1}}/*! MIT License Â© Sindre Sorhus */const O=t=>t!==null&&typeof t=="object",De=typeof globalThis.AbortController=="function",Ie=typeof globalThis.ReadableStream=="function",Re=typeof globalThis.FormData=="function",be=(t,e)=>{const n=new globalThis.Headers(t||{}),r=e instanceof globalThis.Headers,a=new globalThis.Headers(e||{});for(const[l,i]of a)r&&i==="undefined"||i===void 0?n.delete(l):n.set(l,i);return n},ne=(...t)=>{let e={},n={};for(const r of t){if(Array.isArray(r))Array.isArray(e)||(e=[]),e=[...e,...r];else if(O(r)){for(let[a,l]of Object.entries(r))O(l)&&a in e&&(l=ne(e[a],l)),e={...e,[a]:l};O(r.headers)&&(n=be(n,r.headers))}e.headers=n}return e},ge=["get","post","put","patch","head","delete"],ke={json:"application/json",text:"text/*",formData:"multipart/form-data",arrayBuffer:"*/*",blob:"*/*"},Ae=["get","put","head","delete","options","trace"],Se=[408,413,429,500,502,503,504],ye=[413,429,503],Ce=Symbol("stop");class ee extends Error{constructor(e,n,r){super(e.statusText||String(e.status===0||e.status?e.status:"Unknown response error")),this.name="HTTPError",this.response=e,this.request=n,this.options=r}}class re extends Error{constructor(e){super("Request timed out"),this.name="TimeoutError",this.request=e}}const oe=t=>new Promise(e=>setTimeout(e,t)),Ee=(t,e,n)=>new Promise((r,a)=>{const l=setTimeout(()=>{e&&e.abort(),a(new re(t))},n.timeout);n.fetch(t).then(r).catch(a).then(()=>{clearTimeout(l)})}),Pe=t=>ge.includes(t)?t.toUpperCase():t,ie={limit:2,methods:Ae,statusCodes:Se,afterStatusCodes:ye},ve=(t={})=>{if(typeof t=="number")return{...ie,limit:t};if(t.methods&&!Array.isArray(t.methods))throw new Error("retry.methods must be an array");if(t.statusCodes&&!Array.isArray(t.statusCodes))throw new Error("retry.statusCodes must be an array");return{...ie,...t,afterStatusCodes:ye}},Z=2147483647;class ae{constructor(e,n={}){if(this._retryCount=0,this._input=e,this._options={credentials:this._input.credentials||"same-origin",...n,headers:be(this._input.headers,n.headers),hooks:ne({beforeRequest:[],beforeRetry:[],afterResponse:[]},n.hooks),method:Pe(n.method||this._input.method),prefixUrl:String(n.prefixUrl||""),retry:ve(n.retry),throwHttpErrors:n.throwHttpErrors!==!1,timeout:typeof n.timeout>"u"?1e4:n.timeout,fetch:n.fetch||globalThis.fetch.bind(globalThis)},typeof this._input!="string"&&!(this._input instanceof URL||this._input instanceof globalThis.Request))throw new TypeError("`input` must be a string, URL, or Request");if(this._options.prefixUrl&&typeof this._input=="string"){if(this._input.startsWith("/"))throw new Error("`input` must not begin with a slash when using `prefixUrl`");this._options.prefixUrl.endsWith("/")||(this._options.prefixUrl+="/"),this._input=this._options.prefixUrl+this._input}if(De&&(this.abortController=new globalThis.AbortController,this._options.signal&&this._options.signal.addEventListener("abort",()=>{this.abortController.abort()}),this._options.signal=this.abortController.signal),this.request=new globalThis.Request(this._input,this._options),this._options.searchParams){const c="?"+(typeof this._options.searchParams=="string"?this._options.searchParams.replace(/^\?/,""):new URLSearchParams(this._options.searchParams).toString()),u=this.request.url.replace(/(?:\?.*?)?(?=#|$)/,c);(Re&&this._options.body instanceof globalThis.FormData||this._options.body instanceof URLSearchParams)&&!(this._options.headers&&this._options.headers["content-type"])&&this.request.headers.delete("content-type"),this.request=new globalThis.Request(new globalThis.Request(u,this.request),this._options)}this._options.json!==void 0&&(this._options.body=JSON.stringify(this._options.json),this.request.headers.set("content-type","application/json"),this.request=new globalThis.Request(this.request,{body:this._options.body}));const r=async()=>{if(this._options.timeout>Z)throw new RangeError(`The \`timeout\` option cannot be greater than ${Z}`);await oe(1);let i=await this._fetch();for(const c of this._options.hooks.afterResponse){const u=await c(this.request,this._options,this._decorateResponse(i.clone()));u instanceof globalThis.Response&&(i=u)}if(this._decorateResponse(i),!i.ok&&this._options.throwHttpErrors)throw new ee(i,this.request,this._options);if(this._options.onDownloadProgress){if(typeof this._options.onDownloadProgress!="function")throw new TypeError("The `onDownloadProgress` option must be a function");if(!Ie)throw new Error("Streams are not supported in your environment. `ReadableStream` is missing.");return this._stream(i.clone(),this._options.onDownloadProgress)}return i},l=this._options.retry.methods.includes(this.request.method.toLowerCase())?this._retry(r):r();for(const[i,c]of Object.entries(ke))l[i]=async()=>{this.request.headers.set("accept",this.request.headers.get("accept")||c);const u=(await l).clone();if(i==="json"){if(u.status===204)return"";if(n.parseJson)return n.parseJson(await u.text())}return u[i]()};return l}_calculateRetryDelay(e){if(this._retryCount++,this._retryCount<this._options.retry.limit&&!(e instanceof re)){if(e instanceof ee){if(!this._options.retry.statusCodes.includes(e.response.status))return 0;const r=e.response.headers.get("Retry-After");if(r&&this._options.retry.afterStatusCodes.includes(e.response.status)){let a=Number(r);return Number.isNaN(a)?a=Date.parse(r)-Date.now():a*=1e3,typeof this._options.retry.maxRetryAfter<"u"&&a>this._options.retry.maxRetryAfter?0:a}if(e.response.status===413)return 0}return .3*2**(this._retryCount-1)*1e3}return 0}_decorateResponse(e){return this._options.parseJson&&(e.json=async()=>this._options.parseJson(await e.text())),e}async _retry(e){try{return await e()}catch(n){const r=Math.min(this._calculateRetryDelay(n),Z);if(r!==0&&this._retryCount>0){await oe(r);for(const a of this._options.hooks.beforeRetry)if(await a({request:this.request,options:this._options,error:n,retryCount:this._retryCount})===Ce)return;return this._retry(e)}if(this._options.throwHttpErrors)throw n}}async _fetch(){for(const e of this._options.hooks.beforeRequest){const n=await e(this.request,this._options);if(n instanceof Request){this.request=n;break}if(n instanceof Response)return n}return this._options.timeout===!1?this._options.fetch(this.request.clone()):Ee(this.request.clone(),this.abortController,this._options)}_stream(e,n){const r=Number(e.headers.get("content-length"))||0;let a=0;return new globalThis.Response(new globalThis.ReadableStream({async start(l){const i=e.body.getReader();n&&n({percent:0,transferredBytes:0,totalBytes:r},new Uint8Array);async function c(){const{done:u,value:_}=await i.read();if(u){l.close();return}if(n){a+=_.byteLength;const x=r===0?0:a/r;n({percent:x,transferredBytes:a,totalBytes:r},_)}l.enqueue(_),await c()}await c()}}))}}const G=(...t)=>{for(const e of t)if((!O(e)||Array.isArray(e))&&typeof e<"u")throw new TypeError("The `options` argument must be an object");return ne({},...t)},se=t=>{const e=(n,r)=>new ae(n,G(t,r));for(const n of ge)e[n]=(r,a)=>new ae(r,G(t,a,{method:n}));return e.HTTPError=ee,e.TimeoutError=re,e.create=n=>se(G(n)),e.extend=n=>se(G(t,n)),e.stop=Ce,e},Be=se(),Ue=Be,we=async t=>{if(typeof t!="string")throw new TypeError(`Expected a string, got ${typeof t}`);if(!pe(t))return!1;const e=await Ue.head(t,{throwHttpErrors:!1});return e!==void 0&&(e.status<400||e.status>=500)};function qe({showConfirm:t,handleCloseConfirm:e}){const{theme:n}=f.exports.useContext(z);return s(q,{children:s(y,{show:t,onHide:e,children:s(y.Body,{className:`msg-container components-${n} `,children:s(y.Title,{className:"msg-title",children:"Card has been created successfully"})})})})}function Oe(){const{theme:t}=f.exports.useContext(z),[e,n]=f.exports.useState(!1),[r,a]=f.exports.useState(!1),l=ue(),[i,c]=f.exports.useState({}),[u,_]=f.exports.useState(""),{token:x}=f.exports.useContext(ce),{user:T}=f.exports.useContext(Ne),[h,P]=f.exports.useState({businessName:"",businessDescription:"",businessAddress:"",businessPhone:"",businessImage:"businessDefaultCardImage",businessCreateDate:`${new Date().toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}`,cardEditor:`${T==null?void 0:T.firstName} ${T==null?void 0:T.lastName}`}),$=()=>{n(!1),c({})},m=()=>n(!0),A=()=>{a(!1),l("/businesscards")},v=()=>{a(!0),$(),setTimeout(A,3e3)};function B(b){const{name:C,value:H}=b.target;P({...h,[C]:H})}function M(){return!(h.businessName.length<5||h.businessName.length>255)}function V(){return!(h.businessDescription.length<20||h.businessDescription.length>255)}function U(){return!(h.businessAddress.length<5||h.businessAddress.length>255)}function J(){return!(h.businessPhone.length<9||h.businessPhone.length>12||!/^\d+$/.test(h.businessPhone))}function K(){return!(u.length>0&&u.length<20||u.length>255)}async function W(){return await we(u)}function Q(b){b.preventDefault();try{const{businessName:C,businessDescription:H,businessAddress:g,businessPhone:w,businessImage:L,businessCreateDate:X,cardEditor:Y}=h,j=[],F=[],S=[],E=[],D=[],N={};if(console.log(h),_e({businessName:C,businessDescription:H,businessAddress:g,businessPhone:w,businessImage:L,businessCreateDate:X,cardEditor:Y},x),u.length===0?P({...h,businessImage:"businessDefaultCardImage"}):u.length>20&&u.length<255&&W(u).then(k=>{k?(console.log("Image URL exists"),P({...h,businessImage:u})):(console.log("Image URL does not exist"),P({...h,businessImage:"businessDefaultCardImage"}),D.push("Image URL does not exist"),D.length>0&&(N.businessImage=D))}),M()||j.push("Business name must be at least 5 characters"),V()||F.push("Business description must between 20-255 characters"),U()||S.push("Business name must be at least 5 characters"),J()||E.push("Invalid Phone number"),K()||D.push("Business Image URL must be empty or at least 20 characters"),j.length>0&&(N.businessName=j),F.length>0&&(N.businessDescription=F),S.length>0&&(N.businessAddress=S),E.length>0&&(N.businessPhone=E),D.length>0&&(N.businessImage=D),Object.keys(N).length>0)throw c(N),console.log(N),new Error;v()}catch(C){return console.log(C)}}return o(q,{children:[s("button",{className:`buttons-${t} button-control`,onClick:m,children:"Create Card"}),s(y,{show:e,onHide:$,backdrop:"static",keyboard:!1,size:"lg",centered:!0,children:o(y.Body,{className:`components-${t} form-container`,children:[s(y.Title,{className:"form-title mb-2",children:"Create A Card"}),s(te,{className:"form-close-x","aria-label":"Hide",onClick:$}),o(d,{className:"form-inputs-group",onSubmit:Q,children:[o(d.Group,{className:"form-inputs mb-3",children:[o(p,{hasValidation:!0,children:[s(p.Text,{children:s(I,{icon:le})}),s(d.Control,{type:"text",name:"businessName",size:"lg",placeholder:"Business Name",value:h.businessName,onChange:B})]}),i.businessName&&i.businessName.map((b,C)=>s("div",{className:"error text-danger",children:b},C))]}),o(d.Group,{className:"form-inputs mb-3",children:[o(p,{hasValidation:!0,children:[s(p.Text,{children:s(I,{icon:he})}),s(d.Control,{type:"text",name:"businessAddress",size:"lg",placeholder:"Business Address",value:h.businessAddress,onChange:B})]}),i.businessAddress&&i.businessAddress.map((b,C)=>s("div",{className:"error text-danger",children:b},C))]}),o(d.Group,{className:"form-inputs mb-3",children:[o(p,{hasValidation:!0,children:[s(p.Text,{children:s(I,{icon:de})}),s(d.Control,{type:"text",name:"businessPhone",size:"lg",placeholder:"Business Phone",value:h.businessPhone,onChange:B})]}),i.businessPhone&&i.businessPhone.map((b,C)=>s("div",{className:"error text-danger",children:b},C))]}),o(d.Group,{className:"form-inputs mb-3",children:[o(p,{hasValidation:!0,children:[s(p.Text,{children:s(I,{icon:me})}),s(d.Control,{as:"textarea",rows:3,type:"text",name:"businessDescription",size:"lg",placeholder:"Business Description (min 20 characters)",className:"business-description",value:h.businessDescription,onChange:B})]}),i.businessDescription&&i.businessDescription.map((b,C)=>s("div",{className:"error text-danger",children:b},C))]}),o(d.Group,{className:"form-inputs mb-3",children:[o(p,{hasValidation:!0,children:[s(p.Text,{children:s(I,{icon:fe})}),s(d.Control,{type:"text",name:"businessImage",size:"lg",placeholder:"Business Image URL",value:u,onChange:b=>_(b.target.value)})]}),i.businessImage&&i.businessImage.map((b,C)=>s("div",{className:"error text-danger",children:b},C))]}),o("div",{className:"form-btn",children:[s("button",{type:"reset",onClick:$,className:`buttons-${t} button-control me-3`,children:"Close"}),s("button",{type:"submit",className:`buttons-${t} button-control`,children:"Create Card"})]})]})]})}),s(qe,{showConfirm:r,handleCloseConfirm:A})]})}function $e({id:t,card:e,setOpen:n,onDelete:r}){const[a,l]=f.exports.useState(!1),[i,c]=f.exports.useState(!1),{theme:u}=f.exports.useContext(z),_=()=>l(!1),x=()=>{l(!0),n(!1)},T=()=>{r(e==null?void 0:e._id),c(!1)},h=()=>{c(!0),_(),setTimeout(T,3e3)};return o(q,{children:[s("li",{className:`dropdown-item-custom dropdown-item-custom-${u}`,onClick:x,children:"Delete card"}),s(y,{show:a,onHide:_,children:s(y.Body,{className:`msg-container components-${u} `,children:o("div",{className:"msg-grid",children:[s(y.Title,{className:"msg-title",children:"Delete this card?"}),s(te,{className:"msg-close-x","aria-label":"Hide",onClick:_}),o("div",{className:"msg-user-info",children:[o("div",{className:"user-name",children:["Id: ",t+1]}),o("div",{className:"user-name",children:["Business name: ",e==null?void 0:e.businessName]}),o("div",{className:"user-name",children:["Card editor: ",e==null?void 0:e.cardEditor]})]}),o("div",{className:"msg-options ",children:[s("button",{className:`buttons-${u} button-control-close `,onClick:_,children:"Close"}),s("button",{className:`buttons-${u} button-control`,onClick:h,children:"Delete"})]})]})})}),s(y,{show:i,onHide:T,children:s(y.Body,{className:`msg-container components-${u} `,children:s(y.Title,{className:"msg-title",children:"The card has been deleted successfully"})})})]})}function He({showConfirm:t,handleCloseConfirm:e}){const{theme:n}=f.exports.useContext(z);return s(q,{children:s(y,{show:t,onHide:e,children:s(y.Body,{className:`msg-container components-${n} `,children:s(y.Title,{className:"msg-title",children:"The card has been updated successfully"})})})})}function Le({card:t,setOpen:e}){const{theme:n}=f.exports.useContext(z),[r,a]=f.exports.useState(!1),[l,i]=f.exports.useState(!1),[c,u]=f.exports.useState({}),_=ue(),[x,T]=f.exports.useState(""),{token:h}=f.exports.useContext(ce),[P,$]=f.exports.useState(t._id),[m,A]=f.exports.useState({businessName:t.businessName,businessDescription:t.businessDescription,businessAddress:t.businessAddress,businessPhone:t.businessPhone,businessImage:t.businessImage,businessCreateDate:`${new Date().toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}`}),v=()=>a(!1),B=()=>{a(!0),e(!1)},M=()=>{i(!1),e(!1),_("/businesscards")},V=()=>{i(!0),v(),setTimeout(M,3e3)};function U(g){const{name:w,value:L}=g.target;A({...m,[w]:L})}function J(){return!(m.businessName.length<5||m.businessName.length>255)}function K(){return!(m.businessDescription.length<20||m.businessDescription.length>255)}function W(){return!(m.businessAddress.length<5||m.businessAddress.length>255)}function Q(){return!(m.businessPhone.length<9||m.businessPhone.length>12||!/^\d+$/.test(m.businessPhone))}function b(){return!(x.length>0&&x.length<20||x.length>255)}async function C(){return await we(x)}function H(g){g.preventDefault();try{const{businessName:w,businessDescription:L,businessAddress:X,businessPhone:Y,businessImage:j,businessCreateDate:F}=m,S=[],E=[],D=[],N=[],k=[],R={};if(console.log(m),Te({businessName:w,businessDescription:L,businessAddress:X,businessPhone:Y,businessImage:j,businessCreateDate:F},h,P),x.length===0?A({...m,businessImage:"businessDefaultCardImage"}):x.length>20&&x.length<255&&C(x).then(xe=>{xe?(console.log("Image URL exists"),A({...m,businessImage:x})):(console.log("Image URL does not exist"),A({...m,businessImage:"businessDefaultCardImage"}),k.push("Image URL does not exist"),k.length>0&&(R.businessImage=k))}),J()||S.push("Business name must be at least 5 characters"),K()||E.push("Business description must between 20-255 characters"),W()||D.push("Business name must be at least 5 characters"),Q()||N.push("Invalid Phone number"),b()||k.push("Business Image URL must be empty or at least 20 characters"),S.length>0&&(R.businessName=S),E.length>0&&(R.businessDescription=E),D.length>0&&(R.businessAddress=D),N.length>0&&(R.businessPhone=N),k.length>0&&(R.businessImage=k),Object.keys(R).length>0)throw u(R),console.log(R),new Error;V()}catch(w){return console.log(w)}}return o(q,{children:[s("div",{className:`dropdown-item-custom dropdown-item-custom-${n}`,onClick:B,style:{cursor:"pointer"},children:"Update card"}),s(y,{show:r,onHide:v,backdrop:"static",keyboard:!1,size:"lg",centered:!0,children:o(y.Body,{className:`components-${n} form-container`,children:[s(y.Title,{className:"form-title mb-2",children:"Update A Card"}),s(te,{className:"form-close-x","aria-label":"Hide",onClick:v}),o(d,{className:"form-inputs-group",onSubmit:H,children:[o(d.Group,{className:"form-inputs mb-3",children:[o(p,{hasValidation:!0,children:[s(p.Text,{children:s(I,{icon:le})}),s(d.Control,{type:"text",name:"businessName",size:"lg",placeholder:t.businessName,value:m.businessName,onChange:U})]}),c.businessName&&c.businessName.map((g,w)=>s("div",{className:"error text-danger",children:g},w))]}),o(d.Group,{className:"form-inputs mb-3",children:[o(p,{hasValidation:!0,children:[s(p.Text,{children:s(I,{icon:he})}),s(d.Control,{type:"text",name:"businessAddress",size:"lg",placeholder:t.businessAddress,value:m.businessAddress,onChange:U})]}),c.businessAddress&&c.businessAddress.map((g,w)=>s("div",{className:"error text-danger",children:g},w))]}),o(d.Group,{className:"form-inputs mb-3",children:[o(p,{hasValidation:!0,children:[s(p.Text,{children:s(I,{icon:de})}),s(d.Control,{type:"text",name:"businessPhone",size:"lg",placeholder:t.businessPhone,value:m.businessPhone,onChange:U})]}),c.businessPhone&&c.businessPhone.map((g,w)=>s("div",{className:"error text-danger",children:g},w))]}),o(d.Group,{className:"form-inputs mb-3",children:[o(p,{hasValidation:!0,children:[s(p.Text,{children:s(I,{icon:me})}),s(d.Control,{as:"textarea",rows:3,type:"text",name:"businessDescription",size:"lg",placeholder:t.businessDescription+" (min 20 characters)",className:"business-description",value:m.businessDescription,onChange:U})]}),c.businessDescription&&c.businessDescription.map((g,w)=>s("div",{className:"error text-danger",children:g},w))]}),o(d.Group,{className:"form-inputs mb-3",children:[o(p,{hasValidation:!0,children:[s(p.Text,{children:s(I,{icon:fe})}),s(d.Control,{type:"text",name:"businessImage",size:"lg",placeholder:t.businessImage==="businessDefaultCardImage"?"Default Card Image":t.businessImage,value:x,onChange:g=>T(g.target.value)})]}),c.businessImage&&c.businessImage.map((g,w)=>s("div",{className:"error text-danger",children:g},w))]}),o("div",{className:"form-btn",children:[s("button",{type:"reset",onClick:v,className:`buttons-${n} button-control me-3`,children:"Close"}),s("button",{type:"submit",className:`buttons-${n} button-control`,children:"Update Card"})]})]})]})}),s(He,{showConfirm:l,handleCloseConfirm:M})]})}function Ve({id:t,card:e,setOpen:n,onDelete:r}){return o(q,{children:[s(Le,{card:e,setOpen:n}),s($e,{card:e,id:t,onDelete:r,setOpen:n})]})}export{Ve as C,Oe as a};
